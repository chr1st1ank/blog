name: main

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  publish:
    name: ğŸ“– Publish
    runs-on: ubuntu-latest
    steps:
    - name: ğŸšš Checkout
      uses: actions/checkout@v6
    - name: ğŸ’ Setup Ruby
      uses: ruby/setup-ruby@v1.268.0
      with:
        ruby-version: '3.1'
        bundler-cache: true
        cache-version: 0
    - name: ğŸ— Build with Jekyll
      run: bundle exec jekyll build
      env:
        JEKYLL_ENV: production
    - name: ğŸ“‚ Sync files
      if: github.ref == 'refs/heads/main'
      uses: sebastianpopp/ftp-action@v2.0.0
      with:
        host: ${{ secrets.DEPLOY_HOST }}
        user: ${{ secrets.DEPLOY_USER }}
        password: ${{ secrets.DEPLOY_PW }}
        localDir: "./_site/"
        forceSsl: true
